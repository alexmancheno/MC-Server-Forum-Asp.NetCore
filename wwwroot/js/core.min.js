var phpbb={};phpbb.alertTime=100,function(t){"use strict";var e,a={TAB:9,ENTER:13,ESC:27},n=t("#darkenwrapper"),r=null;phpbb.isTouch=window&&"undefined"!=typeof window.ontouchstart,phpbb.loadingIndicator=function(){return e||(e=t("<div />",{id:"loading_indicator"}),e.appendTo("#page-footer")),e.is(":visible")||(e.fadeIn(phpbb.alertTime),phpbb.clearLoadingTimeout(),r=setTimeout(function(){var a=t("#phpbb_alert");e.is(":visible")&&phpbb.alert(a.attr("data-l-err"),a.attr("data-l-timeout-processing-req"))},15e3)),e},phpbb.clearLoadingTimeout=function(){null!==r&&(clearTimeout(r),r=null)},phpbb.closeDarkenWrapper=function(e){r=setTimeout(function(){t("#darkenwrapper").trigger("click")},e)},phpbb.alert=function(e,n){var r=t("#phpbb_alert");return r.find(".alert_title").html(e),r.find(".alert_text").html(n),t(document).on("keydown.phpbb.alert",function(t){(t.keyCode===a.ENTER||t.keyCode===a.ESC)&&(phpbb.alert.close(r,!0),t.preventDefault(),t.stopPropagation())}),phpbb.alert.open(r),r},phpbb.alert.open=function(t){n.is(":visible")||n.fadeIn(phpbb.alertTime),e&&e.is(":visible")?e.fadeOut(phpbb.alertTime,function(){n.append(t),t.fadeIn(phpbb.alertTime)}):n.is(":visible")?(n.append(t),t.fadeIn(phpbb.alertTime)):(n.append(t),t.show(),n.fadeIn(phpbb.alertTime)),t.on("click",function(t){t.stopPropagation()}),n.one("click",function(e){phpbb.alert.close(t,!0),e.preventDefault(),e.stopPropagation()}),t.find(".alert_close").one("click",function(e){phpbb.alert.close(t,!0),e.preventDefault()})},phpbb.alert.close=function(e,a){var r=a?n:e;r.fadeOut(phpbb.alertTime,function(){e.hide()}),e.find(".alert_close").off("click"),t(document).off("keydown.phpbb.alert")},phpbb.confirm=function(e,n,r){var i=t("#phpbb_confirm");return i.find(".alert_text").html(e),r=r||!0,t(document).on("keydown.phpbb.alert",function(e){if(e.keyCode===a.ENTER||e.keyCode===a.ESC){var n=e.keyCode===a.ENTER?"confirm":"cancel";t('input[name="'+n+'"]').trigger("click"),e.preventDefault(),e.stopPropagation()}}),i.find('input[type="button"]').one("click.phpbb.confirmbox",function(t){var e="confirm"===this.name;e&&n(!0),i.find('input[type="button"]').off("click.phpbb.confirmbox"),phpbb.alert.close(i,r||!e),t.preventDefault(),t.stopPropagation()}),phpbb.alert.open(i),i},phpbb.parseQuerystring=function(t){var e,a,n={};for(t=t.split("&"),e=0;e<t.length;e++)a=t[e].split("="),n[a[0]]=decodeURIComponent(a[1]);return n},phpbb.ajaxify=function(a){var i,o=t(a.selector),l=a.refresh,s=a.callback,p="undefined"!=typeof a.overlay?a.overlay:!0,c=o.is("form"),d=o.is('input[type="text"], textarea');return i=c?"submit":d?"keyup":"click",o.on(i,function(i){function o(t,e,a){"undefined"!=typeof console&&console.log&&console.log("AJAX error. status: "+e+", message: "+a),phpbb.clearLoadingTimeout();var r,i=!1;try{r=JSON.parse(t.responseText),r=r.message}catch(o){}"string"==typeof r&&r.length>0?i=r:"string"==typeof a&&a.length>0?i=a:(i=n.attr("data-ajax-error-text-"+e),"string"==typeof i&&i.length||(i=n.attr("data-ajax-error-text"))),phpbb.alert(n.attr("data-ajax-error-title"),i)}function h(a){var i;phpbb.clearLoadingTimeout(),"undefined"==typeof a.S_CONFIRM_ACTION?("undefined"!=typeof a.MESSAGE_TITLE?i=phpbb.alert(a.MESSAGE_TITLE,a.MESSAGE_TEXT):(n.fadeOut(phpbb.alertTime),e&&e.fadeOut(phpbb.alertTime)),"function"==typeof phpbb.ajaxCallbacks[s]&&phpbb.ajaxCallbacks[s].call(v,a),a.REFRESH_DATA&&("function"==typeof l?l=l(a.REFRESH_DATA.url):"boolean"!=typeof l&&(l=!1),r=setTimeout(function(){l&&(window.location=a.REFRESH_DATA.url),n.fadeOut(phpbb.alertTime,function(){"undefined"!=typeof i&&i.hide()})},1e3*a.REFRESH_DATA.time))):phpbb.confirm(a.MESSAGE_BODY,function(e){e&&(phpbb.loadingIndicator(),f=t("<form>"+a.S_HIDDEN_FIELDS+"</form>").serialize(),t.ajax({url:a.S_CONFIRM_ACTION,type:"POST",data:f+"&confirm="+a.YES_VALUE+"&"+t("form","#phpbb_confirm").serialize(),success:h,error:o}))},!1)}var b,u,f,g,v=this,m=t(this);if("false"!==m.find('input[type="submit"][data-clicked]').attr("data-ajax")){var w="function"==typeof a.filter;if(f={},c)b=m.attr("action").replace("&amp;","&"),f=m.serializeArray(),u=m.attr("method")||"GET",m.find('input[type="submit"][data-clicked]')&&(g=m.find('input[type="submit"][data-clicked]'),f.push({name:g.attr("name"),value:g.val()}));else if(d){var y=m.attr("data-name")||this.name;b=m.attr("data-url").replace("&amp;","&"),f[y]=this.value,u="POST"}else b=this.href,f=null,u="GET";var C=function(){var a=m.attr("data-overlay");!p||"undefined"!=typeof a&&"true"!==a||phpbb.loadingIndicator();var n=t.ajax({url:b,type:u,data:f,success:h,error:o,cache:!1});n.always(function(){e&&e.is(":visible")&&e.fadeOut(phpbb.alertTime)})};(!w||a.filter.call(this,f,i,C))&&(C(),i.preventDefault())}}),c&&o.find("input:submit").click(function(){var e=t(this);e.parents("form:first").find("input:submit[data-clicked]").removeAttr("data-clicked"),e.attr("data-clicked","true")}),this},phpbb.search={cache:{data:[]},tpl:[],container:[]},phpbb.search.cache.get=function(t){return this.data[t]?this.data[t]:!1},phpbb.search.cache.set=function(t,e,a){this.data[t]||(this.data[t]={results:[]}),this.data[t][e]=a},phpbb.search.cache.setResults=function(t,e,a){this.data[t].results[e]=a},phpbb.search.cleanKeyword=function(e){return t.trim(e).toLowerCase()},phpbb.search.getKeyword=function(t,e,a){if(a){var n=phpbb.search.getKeywordLine(t);e=e.split("\n").splice(n,1)}return phpbb.search.cleanKeyword(e)},phpbb.search.getKeywordLine=function(t){var e=t.get(0).selectionStart;return t.val().substr(0,e).split("\n").length-1},phpbb.search.setValue=function(t,e,a){if(a){var n=phpbb.search.getKeywordLine(t),r=t.val().split("\n");r[n]=e,e=r.join("\n")}t.val(e)},phpbb.search.setValueOnClick=function(t,e,a,n){a.click(function(){phpbb.search.setValue(t,e.result,t.attr("data-multiline")),n.hide()})},phpbb.search.filter=function(e,a,n){var r=t(this),i=r.attr(void 0!==r.attr("data-name")?"data-name":"name"),o=parseInt(r.attr("data-min-length"),10),l=r.attr("data-results"),s=phpbb.search.getKeyword(r,e[i],r.attr("data-multiline")),p=phpbb.search.cache.get(l),c=!0;e[i]=s,p.timeout&&clearTimeout(p.timeout);var d=setTimeout(function(){if(o>s.length)c=!1;else if(p.lastSearch)if(p.lastSearch===s)c=!1;else{if(p.results[s]){var t={keyword:s,results:p.results[s]};phpbb.search.handleResponse(t,r,!0),c=!1}0===s.indexOf(p.lastSearch)&&0===p.results[p.lastSearch].length&&(phpbb.search.cache.set(l,"lastSearch",s),phpbb.search.cache.setResults(l,s,[]),c=!1)}c&&n.call(this)},350);return phpbb.search.cache.set(l,"timeout",d),!1},phpbb.search.handleResponse=function(e,a,n,r){if("object"==typeof e){var i=a.attr("data-results"),o=t(i);this.cache.get(i).callback?r=this.cache.get(i).callback:"function"==typeof r&&this.cache.set(i,"callback",r),n||this.cache.setResults(i,e.keyword,e.results),this.cache.set(i,"lastSearch",e.keyword),this.showResults(e.results,a,o,r)}},phpbb.search.showResults=function(e,a,n,r){var i=t(".search-results",n);if(this.clearResults(i),!e.length)return void n.hide();var o,l,s=n.attr("id");this.tpl[s]||(o=t(".search-result-tpl",n),this.tpl[s]=o.clone().removeClass("search-result-tpl"),o.remove()),o=this.tpl[s],t.each(e,function(t,e){l=o.clone(),l.find(".search-result").html(e.display),"function"==typeof r&&r.call(this,a,e,l,n),l.appendTo(i).show()}),n.show()},phpbb.search.clearResults=function(t){t.children(":not(.search-result-tpl)").remove()},t("#phpbb").click(function(){var e=t(this);e.is(".live-search")||e.parents().is(".live-search")||t(".live-search").hide()}),phpbb.history={},phpbb.history.isSupported=function(t){return!("undefined"==typeof history||"undefined"==typeof history[t])},phpbb.history.alterUrl=function(t,e,a,n){var r=t+"State";e&&phpbb.history.isSupported(r)&&(a||(a=document.title),n||(n=null),history[r](n,a,e))},phpbb.history.replaceUrl=function(t,e,a){phpbb.history.alterUrl("replace",t,e,a)},phpbb.history.pushUrl=function(t,e,a){phpbb.history.alterUrl("push",t,e,a)},phpbb.timezoneSwitchDate=function(e){var a=t("#timezone_copy"),n=t("#timezone"),r=t("#tz_date"),i=t("#tz_select_date_suggest");0===a.length?n.clone().attr("id","timezone_copy").css("display","none").attr("name","tz_copy").insertAfter("#timezone"):n.html(a.html()),""!==r.val()&&n.children("optgroup").remove(':not([data-tz-value="'+r.val()+'"])'),r.val()===i.attr("data-suggested-tz")?i.css("display","none"):i.css("display","inline");var o=n.children('optgroup[data-tz-value="'+r.val()+'"]').children("option");if(1===o.length&&(o.prop("selected",!0),e=!0),"undefined"!=typeof e&&!e){var l=n.find("optgroup option");l.filter(":selected").length<=0&&l.filter(":first").prop("selected",!0)}},phpbb.timezoneEnableDateSelection=function(){t("#tz_select_date").css("display","block")},phpbb.timezonePreselectSelect=function(e){var a=(new Date).getTimezoneOffset(),n="-";0>a&&(n="+",a=-a);var r=a%60,i=(a-r)/60;i=10>i?"0"+i.toString():i.toString(),r=10>r?"0"+r.toString():r.toString();var o,l="UTC"+n+i+":"+r,s=l.length,p=t("option","#tz_date"),c=t("#tz_select_date_suggest");for(o=0;o<p.length;++o){var d=p[o];if(d.value.substring(0,s)===l){t("#tz_date").val()===d.value||e?(d.selected=!0,phpbb.timezoneSwitchDate(!e),c.css("display","none")):(phpbb.timezoneSwitchDate(!0),c.css("display","inline"));var h=c.attr("data-l-suggestion");return c.attr("title",h.replace("%s",d.innerHTML)),c.attr("value",h.replace("%s",d.innerHTML.substring(0,9))),void c.attr("data-suggested-tz",d.innerHTML)}}},phpbb.ajaxCallbacks={},phpbb.addAjaxCallback=function(t,e){return"function"==typeof e&&(phpbb.ajaxCallbacks[t]=e),this},phpbb.addAjaxCallback("member_search",function(e){phpbb.search.handleResponse(e,t(this),!1,phpbb.getFunctionByName("phpbb.search.setValueOnClick"))}),phpbb.addAjaxCallback("alt_text",function(){var e,a,n=t(this).data("update-all");e=t(void 0!==n&&n.length?n:this),e.each(function(){var e=t(this);a=e.attr("data-alt-text"),e.attr("data-alt-text",e.text()),e.attr("title",t.trim(a)),e.text(a)})}),phpbb.addAjaxCallback("toggle_link",function(){var e,a,n,r,i=t(this).data("update-all");e=t(void 0!==i&&i.length?i:this),e.each(function(){var e=t(this);a=e.attr("data-toggle-text"),e.attr("data-toggle-text",e.text()),e.attr("title",t.trim(a)),e.text(a),n=e.attr("data-toggle-url"),e.attr("data-toggle-url",e.attr("href")),e.attr("href",n),r=e.attr("data-toggle-class"),e.attr("data-toggle-class",e.parent().attr("class")),e.parent().attr("class",r)})}),phpbb.resizeTextArea=function(e,a){function n(e){var a=t(e);a.hasClass("auto-resized")&&(t(e).css({height:"",resize:""}).removeClass("auto-resized"),i.resetCallback.call(e,a))}function r(e){function a(t){t+=parseInt(l.css("height"),10)-l.innerHeight(),l.css({height:t+"px",resize:"none"}).addClass("auto-resized"),i.resizeCallback.call(e,l)}var r=t(window).height();if(r<i.minWindowHeight)return void n(e);var o=Math.min(Math.max(r-i.heightDiff,i.minHeight),i.maxHeight),l=t(e),s=parseInt(l.innerHeight(),10),p=e.scrollHeight?e.scrollHeight:0;0>s||(s>o?a(o):p>s+5&&a(Math.min(o,p)))}var i={minWindowHeight:500,minHeight:200,maxHeight:500,heightDiff:200,resizeCallback:function(){},resetCallback:function(){}};phpbb.isTouch||(arguments.length>1&&(i=t.extend(i,a)),e.on("focus change keyup",function(){t(this).each(function(){r(this)})}).change(),t(window).resize(function(){e.each(function(){t(this).hasClass("auto-resized")&&r(this)})}))},phpbb.inBBCodeTag=function(t,e,a){var n,r,i,o=t.selectionStart,l=-1,s=-1;if("number"!=typeof o)return!1;for(i=t.value.toLowerCase(),n=0;n<e.length;n++){var p=e[n].length;o>=p&&(r=i.lastIndexOf(e[n],o-p),s=Math.max(s,r))}if(-1===s)return!1;if(o>0)for(n=0;n<a.length;n++)r=i.lastIndexOf(a[n],o-1),l=Math.max(l,r);return s>l},phpbb.applyCodeEditor=function(e){function n(){return phpbb.inBBCodeTag(e,o,s)}function r(t){var a=e.selectionStart,n=e.value,r=n.lastIndexOf("\n",a-1);if(n=n.substring(r+1,a),t)for(var i=0;i<o.length;i++)if(r=n.lastIndexOf(o[i]),r>=0){var s=o[i].length;n=n.substring(r+s),o[i].lastIndexOf(l)!==s&&(r=n.indexOf(l),r>=0&&(n=n.substr(r+1)))}return n}function i(t){var a=e.selectionStart,n=e.selectionEnd,r=e.value;e.value=r.substr(0,a)+t+r.substr(n),e.selectionStart=e.selectionEnd=a+t.length}var o=["[code]","[code="],l="]",s=["[/code]"];e&&"number"==typeof e.selectionStart&&t(e).data("code-editor")!==!0&&t(e).data("code-editor",!0).on("keydown",function(t){var e=t.keyCode||t.which;if(!(e!==a.TAB||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)&&n())return i("	"),void t.preventDefault();if(e===a.ENTER&&n()){var o=r(!0),l=""+/^\s*/g.exec(o);l.length>0&&(i("\n"+l),t.preventDefault())}})},phpbb.showDragNDrop=function(e){e&&(t("body").on("dragenter dragover",function(){t(e).addClass("drag-n-drop")}).on("dragleave dragout dragend drop",function(){t(e).removeClass("drag-n-drop")}),t(e).on("dragenter dragover",function(){t(e).addClass("drag-n-drop-highlight")}).on("dragleave dragout dragend drop",function(){t(e).removeClass("drag-n-drop-highlight")}))},phpbb.dropdownHandles=".dropdown-container.dropdown-visible .dropdown-toggle",phpbb.dropdownVisibleContainers=".dropdown-container.dropdown-visible",phpbb.toggleDropdown=function(){var e,a=t(this),n=a.data("dropdown-options"),r=n.parent,i=r.hasClass("dropdown-visible");if(!i){t(phpbb.dropdownHandles).each(phpbb.toggleDropdown),e=n.direction;var o=n.verticalDirection,l=a.offset();if("auto"===e&&(e=(t(window).width()-a.outerWidth(!0))/2>l.left?"right":"left"),r.toggleClass(n.leftClass,"left"===e).toggleClass(n.rightClass,"right"===e),"auto"===o){var s=t(window).height(),p=l.top-t(window).scrollTop();o=.7*s>p?"down":"up"}r.toggleClass(n.upClass,"up"===o).toggleClass(n.downClass,"down"===o)}if(n.dropdown.toggle(),r.toggleClass(n.visibleClass,!i).toggleClass("dropdown-visible",!i),!i){var c=t(window).width();n.dropdown.find(".dropdown-contents").each(function(){var e=t(this);e.css({marginLeft:0,left:0,maxWidth:c-4+"px"});var a=e.offset().left,n=e.outerWidth(!0);2>a?e.css("left",2-a+"px"):a+n+2>c&&e.css("margin-left",c-a-n-2+"px"),e.toggleClass("dropdown-nonscroll",this.scrollHeight===e.innerHeight())});var d=r.offset().left-4;if("left"===e){if(n.dropdown.css("margin-left","-"+d+"px"),n.dropdown.hasClass("dropdown-extended")){var h,b=d+r.outerWidth();n.dropdown.find(".dropdown-contents").each(function(){h=parseInt(t(this).outerWidth(),10),t(this).css({marginLeft:0,left:0})});var u=Math.min(h,b)+"px";n.dropdown.css({width:u,marginLeft:-u})}}else n.dropdown.css("margin-right","-"+(c+d)+"px")}if(arguments.length>0)try{var f=arguments[0];f.preventDefault(),f.stopPropagation()}catch(g){}return!1},phpbb.toggleSubmenu=function(e){t(this).siblings(".dropdown-submenu").toggle(),e.preventDefault()},phpbb.registerDropdown=function(e,a,n){var r={parent:e.parent(),direction:"auto",verticalDirection:"auto",visibleClass:"visible",leftClass:"dropdown-left",rightClass:"dropdown-right",upClass:"dropdown-up",downClass:"dropdown-down"};n&&(r=t.extend(r,n)),r.dropdown=a,r.parent.addClass("dropdown-container"),e.addClass("dropdown-toggle"),e.data("dropdown-options",r),e.click(phpbb.toggleDropdown),t(".dropdown-toggle-submenu",r.parent).click(phpbb.toggleSubmenu)},phpbb.colorPalette=function(t,e,a){var n,r,i,o=new Array(6),l="",s="";o[0]="00",o[1]="40",o[2]="80",o[3]="BF",o[4]="FF";var p="h"===t?"horizontal-palette":"vertical-palette";for(s+='<table class="not-responsive colour-palette '+p+'" style="width: auto;">',n=0;5>n;n++){for("h"===t&&(s+="<tr>"),r=0;5>r;r++){for("v"===t&&(s+="<tr>"),i=0;5>i;i++)l=""+o[n]+o[r]+o[i],s+='<td style="background-color: #'+l+"; width: "+e+"px; height: "+a+'px;"><a href="#" data-color="'+l+'" style="display: block; width: '+e+"px; height: "+a+'px; " alt="#'+l+'" title="#'+l+'"></a>',s+="</td>";"v"===t&&(s+="</tr>")}"h"===t&&(s+="</tr>")}return s+="</table>"},phpbb.registerPalette=function(e){var a=e.attr("data-orientation"),n=e.attr("data-height"),r=e.attr("data-width"),i=e.attr("data-target"),o=e.attr("data-bbcode");e.html(phpbb.colorPalette(a,r,n)),t("#color_palette_toggle").click(function(t){e.toggle(),t.preventDefault()}),t(e).on("click","a",function(e){var a=t(this).attr("data-color");o?bbfontstyle("[color=#"+a+"]","[/color]"):t(i).val(a),e.preventDefault()})},phpbb.toggleDisplay=function(e,a,n){n||(n="block");var r=t("#"+e),i=r.css("display");a||(a=""===i||i===n?-1:1),r.css("display",1===a?n:"none")},phpbb.toggleSelectSettings=function(e){e.children().each(function(){var e=t(this),a=t(e.data("toggle-setting"));a.toggle(e.is(":selected")),e.is(":selected")?t(e.data("toggle-setting")+" input").prop("disabled",!1):t(e.data("toggle-setting")+" input").prop("disabled",!0)})},phpbb.getFunctionByName=function(t){for(var e=t.split("."),a=e.pop(),n=window,r=0;r<e.length;r++)n=n[e[r]];return n[a]},phpbb.registerPageDropdowns=function(){var e=t("body");e.find(".dropdown-container").each(function(){var e,a=t(this),n=a.find(".dropdown-trigger:first"),r=a.find(".dropdown"),i={direction:"auto",verticalDirection:"auto"};n.length||(e=a.attr("data-dropdown-trigger"),n=a.children(e?e:"a:first")),r.length||(e=a.attr("data-dropdown-contents"),r=a.children(e?e:"div:first")),n.length&&r.length&&(a.hasClass("dropdown-up")&&(i.verticalDirection="up"),a.hasClass("dropdown-down")&&(i.verticalDirection="down"),a.hasClass("dropdown-left")&&(i.direction="left"),a.hasClass("dropdown-right")&&(i.direction="right"),phpbb.registerDropdown(n,r,i))}),e.click(function(e){var a=t(e.target).parents();a.is(phpbb.dropdownVisibleContainers)||t(phpbb.dropdownHandles).each(phpbb.toggleDropdown)})},phpbb.lazyLoadAvatars=function(){t(".avatar[data-src]").each(function(){var e=t(this);e.attr("src",e.data("src")).removeAttr("data-src")})},t(window).load(phpbb.lazyLoadAvatars),t(function(){t("textarea[data-bbcode]").each(function(){phpbb.applyCodeEditor(this)}),phpbb.registerPageDropdowns(),t("#color_palette_placeholder").each(function(){phpbb.registerPalette(t(this))}),phpbb.history.replaceUrl(t("#unread[data-url]").data("url")),t("select[data-togglable-settings]").each(function(){var e=t(this);e.change(function(){phpbb.toggleSelectSettings(e)}),phpbb.toggleSelectSettings(e)})})}(jQuery);